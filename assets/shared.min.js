function $(e){return document.getElementById(e)}function storageGet(e,t){try{const r=localStorage.getItem(e);return r?JSON.parse(r):t}catch{return t}}function storageSet(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch{}}function prefersReducedMotion(){return window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches}function injectHeaderFooter(e){const t=`
<header>
  <div class="nav">
  <a href="index.html" class="brand" aria-label="Home"><div class="logo">DR</div> <span>DeFi‑RealEstate</span></a>
    <div class="grow"></div>
    <nav role="navigation" aria-label="Primary">
      <a href="index.html" data-page="home" data-i18n="nav_home">Home</a>
      <a href="dividends.html" data-page="dividends" data-i18n="nav_dividends">Dividend Tracker</a>
      <a href="growth.html" data-page="growth" data-i18n="nav_growth">Growth & Forecast</a>
      <a href="marketplace.html" data-page="market" data-i18n="nav_market">Marketplace</a>
      <a href="admin.html" data-page="admin" data-i18n="nav_admin">Admin</a>
    </nav>
    <div class="controls">
      <select id="langSel" aria-label="Language">
        <option value="en">English</option>
        <option value="vi">Tiếng Việt</option>
  </select>
    </div>
  </div>
</header>`,n=`
<footer role="contentinfo">
  <div class="foot">
    <div>© <span id="yr"></span> DeFi‑RealEstate • <span data-i18n="foot_rights">All rights reserved.</span></div>
    <div class="muted">Made for demo — mock data only. · <a href="https://sonnil.github.io/DeFi-RealEstate/" target="_blank" rel="noopener">Live site</a> · <a href="https://github.com/Sonnil/DeFi-RealEstate/issues" target="_blank" rel="noopener">Report issue</a></div>
  </div>
</footer>`;document.body.insertAdjacentHTML("afterbegin",t),document.body.insertAdjacentHTML("beforeend",n),"function"==typeof initHeader&&initHeader(e)}function openModal(e,t){const n=$(e),o=$(t);if(n&&o){o.classList.add("show"),n.classList.add("show");const r=n.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),f=r[0],l=r[r.length-1];function a(e){"Tab"===e.key?(e.shiftKey&&document.activeElement===f?(e.preventDefault(),l.focus()):!e.shiftKey&&document.activeElement===l&&(e.preventDefault(),f.focus())):"Escape"===e.key&&closeModal(n.id,o.id)}n.dataset.trap="1",document.addEventListener("keydown",a),n.__trapHandler=a,setTimeout((()=>{var e;return null===(e=f)||void 0===e?void 0:e.focus()}),0)}}function closeModal(e,t){const n=$(e),o=$(t);n&&o&&(o.classList.remove("show"),n.classList.remove("show"),n.__trapHandler&&(document.removeEventListener("keydown",n.__trapHandler),delete n.__trapHandler))}function onlyDigits(e){try{return(e||"").replace(/\D/g,"")}catch{return""}}function luhnCheck(e){const t=onlyDigits(e);if(!t||t.length<13||t.length>19)return!1;let n=0,o=!1;for(let e=t.length-1;e>=0;e--){let r=t.charCodeAt(e)-48;if(r<0||r>9)return!1;o&&(r*=2,r>9&&(r-=9)),n+=r,o=!o}return n%10==0}function validExpiry(e){if(!e)return!1;const t=String(e).match(/^(\d{2})\s*\/\s*(\d{2}|\d{4})$/);if(!t)return!1;let n=parseInt(t[1],10),o=parseInt(t[2],10);if(n<1||n>12)return!1;o<100&&(o+=2e3);const r=new Date,a=r.getFullYear(),i=r.getMonth()+1;return o>a||o===a&&n>=i}function formatCardNumber(e){const t=onlyDigits(e).slice(0,19);return t.replace(/(.{4})/g,"$1 ").trim()}
