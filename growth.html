<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>DeFi‑RealEstate — Growth & Forecast</title>
<meta name="description" content="Model mortgage amortization, appreciation, and equity growth with a year-by-year table.">
<!-- Critical CSS for faster first paint; full stylesheet loads asynchronously -->
<style>
  :root{--bg:#0b0d12;--card:#111623;--text:#e9eef5;--muted:#a9b2c2;--primary:#2e7cf6}
  html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Inter,Arial,sans-serif}
  main{padding:16px}
  .card{background:var(--card);border-radius:12px;padding:20px}
  .muted{color:var(--muted)}
  button.primary{background:var(--primary);color:#fff;border:0;padding:10px 14px;border-radius:8px;cursor:pointer}
  button.secondary{background:#1b2133;color:#e9eef5;border:1px solid #2a3550;padding:10px 14px;border-radius:8px;cursor:pointer}
  .table{width:100%;border-collapse:collapse}
  .table th,.table td{padding:8px;border-bottom:1px solid #1f2a44}
  @media (max-width:720px){ main{padding:12px} }
</style>
<link rel="preload" href="assets/style.min.css?v=4" as="style">
<link rel="stylesheet" href="assets/style.min.css?v=4" media="print" onload="this.media='all'">
<noscript><link rel="stylesheet" href="assets/style.min.css?v=4"></noscript>
</head>
<body>



<main>
  <div class="grid cols-2">
    <div class="card">
      <h2 data-i18n="g_title">Property Growth & Equity Forecast</h2>
      <div class="row">
        <div class="field"><label data-i18n="g_purchase">Purchase price ($)</label><input id="g-price" type="number" value="400000" step="1000"></div>
        <div class="field"><label data-i18n="g_down">Down payment (%)</label><input id="g-down" type="number" value="20" step="1"></div>
        <div class="field"><label data-i18n="g_rate">Interest rate (%)</label><input id="g-rate" type="number" value="6.5" step="0.1"></div>
        <div class="field"><label data-i18n="g_term">Term (years)</label><input id="g-term" type="number" value="30" step="1"></div>
        <div class="field"><label data-i18n="g_app">Appreciation/yr (%)</label><input id="g-app" type="number" value="3.5" step="0.1"></div>
        <div class="field"><label data-i18n="g_extra">Extra principal/mo ($)</label><input id="g-extra" type="number" value="0" step="50"></div>
      </div>
      <div style="display:flex;gap:10px;margin-top:12px">
        <button class="primary" id="g-run" data-i18n="run">Run Forecast</button>
      </div>
      <p class="help" id="g-msg" aria-live="polite"></p>
      <canvas id="g-chart" height="240" style="margin-top:14px;width:100%"></canvas>
    </div>
    <div class="card">
      <h3 data-i18n="g_table">Year‑by‑Year</h3>
      <table class="table">
        <thead><tr><th data-i18n="t_year">Year</th><th data-i18n="t_value">Value</th><th data-i18n="t_principal">Principal Paid</th><th data-i18n="t_equity">Equity</th></tr></thead>
        <tbody id="g-tbody"></tbody>
        <tfoot><tr><th data-i18n="t_cagr">CAGR</th><th id="g-cagr" colspan="3">—</th></tr></tfoot>
      </table>
    </div>
  </div>
</main>



<script src="assets/app.min.js?v=6"></script>
<script src="assets/shared.min.js?v=5"></script>
<script src="assets/i18n-extra.js?v=2"></script>
<script>
injectHeaderFooter("growth");
function runGrowth(){
  const priceEl=document.getElementById("g-price");
  const downEl=document.getElementById("g-down");
  const rateEl=document.getElementById("g-rate");
  const termEl=document.getElementById("g-term");
  const appEl=document.getElementById("g-app");
  const extraEl=document.getElementById("g-extra");
  const msg=document.getElementById("g-msg");
  [priceEl,downEl,rateEl,termEl,appEl,extraEl].forEach(el=>{ el.classList.remove('error'); el.removeAttribute('aria-invalid'); });
  if(msg) msg.textContent='';

  const price=+priceEl.value||0;
  const downPct=(+downEl.value||0)/100;
  const rate=(+rateEl.value||0)/100;
  const term=+termEl.value||30;
  const app=(+appEl.value||0)/100;
  const extra=+extraEl.value||0;

  const lang=localStorage.getItem('lang')||'en';
  if(!(price>0)){ msg.textContent=(I18N[lang]&&I18N[lang].g_err_price)||'Purchase price must be greater than 0.'; priceEl.classList.add('error'); priceEl.setAttribute('aria-invalid','true'); priceEl.focus(); return; }
  if(downPct<0 || downPct>=1){ msg.textContent=(I18N[lang]&&I18N[lang].g_err_down)||'Down payment must be between 0 and 100.'; downEl.classList.add('error'); downEl.setAttribute('aria-invalid','true'); downEl.focus(); return; }
  if(rate<0){ msg.textContent=(I18N[lang]&&I18N[lang].g_err_rate)||'Interest rate cannot be negative.'; rateEl.classList.add('error'); rateEl.setAttribute('aria-invalid','true'); rateEl.focus(); return; }
  if(!(term>0)){ msg.textContent=(I18N[lang]&&I18N[lang].g_err_term)||'Term must be greater than 0 years.'; termEl.classList.add('error'); termEl.setAttribute('aria-invalid','true'); termEl.focus(); return; }
  if(app<-1){ msg.textContent=(I18N[lang]&&I18N[lang].g_err_app)||'Appreciation cannot be less than -100%.'; appEl.classList.add('error'); appEl.setAttribute('aria-invalid','true'); appEl.focus(); return; }
  if(extra<0){ msg.textContent=(I18N[lang]&&I18N[lang].g_err_extra)||'Extra principal cannot be negative.'; extraEl.classList.add('error'); extraEl.setAttribute('aria-invalid','true'); extraEl.focus(); return; }

  const loan=price*(1-downPct);
  const n=term*12; const r=rate/12;
  const basePmt = r ? (loan*r)/(1-Math.pow(1+r,-n)) : loan/n;

  let bal=loan, value=price, year=0;
  const tbody=document.getElementById("g-tbody"); tbody.innerHTML="";
  const equities=[], values=[]; let totalPrincipal=0;

  for(let m=1;m<=n && bal>0.01;m++){
    const interest=r? bal*r:0;
    const pmt=Math.min(basePmt+extra, bal+interest);
    const principal=pmt-interest;
    bal-=principal; totalPrincipal+=principal;
    value *= (1+app/12);
    if(m%12===0){
      year++;
      const equity=Math.max(0,value-bal);
      equities.push(equity); values.push(value);
      const tr=document.createElement("tr");
      tr.innerHTML = `<td>${year}</td><td>${formatMoney(value)}</td><td>${formatMoney(totalPrincipal)}</td><td>${formatMoney(equity)}</td>`;
      tbody.appendChild(tr);
    }
  }
  const yrs = equities.length||1;
  const finalVal = values[values.length-1]||price;
  const cagr = Math.pow(finalVal/price,1/yrs)-1;
  document.getElementById("g-cagr").textContent = (isFinite(cagr)?(cagr*100).toFixed(2):"0")+"%";
  drawLine("g-chart", equities.map(e=>e/1000));
}
document.getElementById("g-run").onclick=runGrowth;
["g-price","g-down","g-rate","g-term","g-app","g-extra"].forEach(id=>{
  document.getElementById(id).addEventListener('input', ()=>{
    const el=document.getElementById(id); el.classList.remove('error'); el.removeAttribute('aria-invalid'); const m=document.getElementById('g-msg'); if(m) m.textContent='';
  });
});
runGrowth();
</script>
</body>
</html>
