<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>DeFi‑RealEstate — Admin</title>
<meta name="description" content="Admin demo to add and manage mock real estate listings stored locally for the Marketplace page.">
<link rel="stylesheet" href="assets/style.min.css?v=1" />
</head>
<body>



<main>
  <div class="card">
    <h2 data-i18n="a_title">Admin — Add Property (Demo)</h2>
    <p class="muted" data-i18n="a_desc">Add demo listings. They appear in the Marketplace and are stored locally for this session.</p>
    <div class="row-4">
      <div class="field"><label data-i18n="a_address">Address</label><input id="a-address" placeholder="123 Palm Ave, Orlando, FL"></div>
      <div class="field"><label data-i18n="a_type">Type</label><select id="a-type"><option>Single Family</option><option>Condo</option><option>Townhome</option></select></div>
      <div class="field"><label data-i18n="a_price">Price ($)</label><input id="a-price" type="number" step="1000"></div>
      <div class="field"><label data-i18n="a_cap">Cap Rate (%)</label><input id="a-cap" type="number" step="0.1" value="5.5"></div>
      <div class="field"><label data-i18n="a_beds">Beds</label><input id="a-beds" type="number" step="1"></div>
      <div class="field"><label data-i18n="a_baths">Baths</label><input id="a-baths" type="number" step="1"></div>
      <div class="field"><label data-i18n="a_sqft">Sqft</label><input id="a-sqft" type="number" step="50"></div>
      <div class="field"><label data-i18n="a_raise">Total Raise ($)</label><input id="a-raise" type="number" step="1000"></div>
      <div class="field"><label data-i18n="a_img">Image URL</label><input id="a-img" placeholder="https://..."></div>
      <div class="field" style="grid-column:span 3"><label data-i18n="a_desc_label">Description</label><input id="a-desc" placeholder="Highlights, neighborhood, upgrades..."></div>
    </div>
    <div style="display:flex;gap:10px;margin-top:12px">
      <button class="primary" id="a-add" data-i18n="add">Add</button>
      <button class="danger" id="a-clear" data-i18n="clear">Clear All</button>
    </div>
  </div>

  <div class="card">
    <h3 data-i18n="a_current">Current Offerings</h3>
    <table class="table">
      <thead><tr><th data-i18n="t_address">Address</th><th data-i18n="t_price">Price</th><th data-i18n="t_raise">Raise</th><th data-i18n="t_available">Available</th><th></th></tr></thead>
      <tbody id="a-tbody"></tbody>
    </table>
  </div>
</main>



<script src="assets/app.min.js?v=1"></script>
<script src="assets/shared.min.js?v=1"></script>
<script>
injectHeaderFooter("admin");
let listings = getMockListings();
function renderAdminTable(){
  const tb=document.getElementById("a-tbody"); tb.innerHTML="";
  listings.forEach(p=>{
    const tr=document.createElement("tr");
    tr.innerHTML=`<td>${p.address}</td><td>${formatMoney(p.price)}</td><td>${formatMoney(p.totalRaise)}</td><td>${formatMoney(p.availableRaise)}</td><td><button class="danger" data-id="${p.id}" data-action="remove">Remove</button></td>`;
    tb.appendChild(tr);
  });
}
document.getElementById("a-add").onclick=()=>{
  const g=id=>document.getElementById(id).value;
  const price=+g("a-price")||0, raise=+g("a-raise")||0;
  const id="P-"+Math.random().toString(36).slice(2,7).toUpperCase();
  const p={id,ts:Date.now(),address:g("a-address"),type:g("a-type"),price,
           beds:+g("a-beds")||0,baths:+g("a-baths")||0,sqft:+g("a-sqft")||0,
           capRate:+g("a-cap")||null,totalRaise:raise||Math.round(price*0.3),
           availableRaise:raise||Math.round(price*0.3),image:g("a-img"),
           description:g("a-desc"),sourceUrl:"#"};
  listings.unshift(p); saveMockListings(listings); renderAdminTable();
  const lang=localStorage.getItem("lang")||"en";
  alert(lang==="vi"?"Đã thêm dự án demo!":"Added demo listing!");
};
document.getElementById("a-clear").onclick=()=>{
  if(confirm("Clear all demo listings?")){ listings=[]; saveMockListings(listings); renderAdminTable(); }
};
document.getElementById("a-tbody").addEventListener("click",e=>{
  const btn=e.target.closest("button[data-action='remove']"); if(!btn)return;
  const id=btn.getAttribute("data-id");
  listings=listings.filter(x=>x.id!==id); saveMockListings(listings); renderAdminTable();
});
renderAdminTable();
</script>
</body>
</html>
